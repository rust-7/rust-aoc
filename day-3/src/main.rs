fn main() {
    part1();
    part2();
}

fn part1() {
    let number_of_trees = compute_number_of_trees(raw_input(), 3, 1);

    println!("Number of trees: {}", number_of_trees);
}

fn part2() {

    let result = compute_number_of_trees(raw_input(), 1, 1) *
        compute_number_of_trees(raw_input(), 3, 1) *
        compute_number_of_trees(raw_input(), 5, 1) *
        compute_number_of_trees(raw_input(), 7, 1) *
        compute_number_of_trees(raw_input(), 1, 2);

    println!("Result is {}", result);
}

fn compute_number_of_trees(raw_input: &str, right: usize, down: usize) -> u32 {
    let map = input(raw_input);

    let mut column_index = 0;
    let mut number_of_trees = 0;

    for (index, line) in map.iter().enumerate() {
        if (index % down) != 0 {
            continue;
        }

        match line[column_index % line.len()] {
            Spot::Empty => {},
            Spot::Tree => { number_of_trees += 1 }
        };
        column_index += right;
    }

    number_of_trees
}

#[test]
fn test_number_of_trees() {
    let raw_input = "
    ..##.......
    #...#...#..
    .#....#..#.
    ..#.#...#.#
    .#...##..#.
    ..#.##.....
    .#.#.#....#
    .#........#
    #.##...#...
    #...##....#
    .#..#...#.#
    ";

    assert_eq!(2, compute_number_of_trees(raw_input, 1, 1));
    assert_eq!(7, compute_number_of_trees(raw_input, 3, 1));
    assert_eq!(3, compute_number_of_trees(raw_input, 5, 1));
    assert_eq!(4, compute_number_of_trees(raw_input, 7, 1));
    assert_eq!(2, compute_number_of_trees(raw_input, 1, 2));
}

enum Spot {
    Empty,
    Tree,
}

fn input(raw_input: &str) -> Vec<Vec<Spot>> {
    raw_input
        .trim()
        .lines()
        .map(|line| {
            line.trim().chars().map(|one_char| {
                match one_char {
                    '.' => Spot::Empty,
                    '#' => Spot::Tree,
                    _ => panic!("Unknown character."),
                }
            }).collect()
        })
        .collect()
}

fn raw_input() -> &'static str {
    "
    ......#..........##......#.####
    .##...###....#.....#...#.#.....
    #..##..#.....#............#.#.#
    ##.#....#####..#....#..#.#.....
    ..#.#...##.##.......#.#..#..##.
    ##.#.......#.#.#..#...#.#...#..
    ...#...#..#.##....##..#.#......
    .......##.#.#.#.##...#.........
    ..#...##.##...##..##.##...#....
    .#.#...#.....####..#.#...#.##..
    .#...#......##......##....#....
    ..#.....#.........##.#...#.#...
    ...#.#...#..##...#....#.....##.
    ..#.....#..#..#......###.......
    ...##.#....##..##...........#..
    ....#......#..#....###...#.....
    .....#...#.#.....#..##........#
    ....#...#....##.#.##.#...#..#.#
    .......##.#......##....#....#..
    ...#.#...##..#...#..#..#..##.#.
    ##.#...#..#..................##
    ##........#....##...#..#..#....
    .#.#..............#######.##...
    ##..#..#.#.##..#...............
    ..#........#..#...##.......#...
    ............##.##.#..........##
    .....##..#.....##..#.....#.....
    ..#.##.###.#..##.............#.
    .........##...........#.....#..
    ..#....#.#.###.#.#.......##....
    ..###..##..#.#.##......#.#.##..
    ##......#.#....##.#..#.#..#.#.#
    ..##.#.###.#...#...............
    ..####.......#...#.##....#.....
    ..#....##...#.#.#.#....#.##..##
    .#...####..###....#.###...##...
    ..#.#..........#.#..#..#.....##
    .#....#.........###...#.....##.
    ..#.#.#.##........#.##.#.....#.
    #....#....###...#..#.........#.
    #..#.###....#..............#...
    ............#....##.#......#.#.
    ...#..#.####...............##..
    ....##......#.#.........####..#
    .#....###..#.#..##........##...
    #..##.....###..#...............
    ..#...........#........#...#..#
    ......................#.#..#...
    .#.##.#..#.#....#...#...#.#....
    ..#..#.........#..#.#..........
    .#......#####...#......#..#....
    ..........#.....#..#.##.####.##
    ##.##..#............#####...#.#
    ..##..#..###......#...#...#....
    ....#####........#.##...###....
    ......#...##..#..#............#
    ...#....##.##...#..#...#.......
    ....#####.#...............###..
    .#....#..##....#.#.#..##.##...#
    ...#..#..#........#.#####.....#
    ......##.#...#..#..#.....#..###
    ###.......#.#........#......#.#
    ..#.#..#..#........#..#......#.
    ...##.........#..........#.....
    ...#..###.#.......#.#.........#
    ....#..#.##...##.....#.....##..
    #.#.#.#.....##.##.###..#.#....#
    ..#....#.....##.####..#........
    ...#..#.##.....##.#..#....###..
    .#..#.....#....#...#.#.......##
    ..#..#.......#.#.###......#.##.
    .###.####....##............##.#
    #....###.#......##.#......##.#.
    .##...........#.#....#.........
    #.##..##...#...........###....#
    #.#..#...#.#..#..###.#.##...#..
    ..#...#.#..##....#..#..#.......
    #..##..#.####...#...#..####.##.
    ###..#.##....#...#.###..##...##
    ##..#..#.#....#.....##.......#.
    ..#..##.##.#.......###.#.....#.
    ..........#.####....#.......#..
    #...#.#..#.......##......##..##
    ##...##.##..###...............#
    ....##.#...#.......##...##..#..
    .#.........#...#.#...##.#.....#
    .#...#.#..#...#..##....#..#...#
    .#.#...#..#..###...##....#.....
    .........#.#...####..#...#.#...
    ...#.............#.#..........#
    ...#...#..##.#........#.#......
    ...#...#.....#....#..###.##.###
    .#.#........#....#...#.###.#.#.
    ##.....#.......#..##.#....#..##
    ...###...#.#.#.#....#.#....#...
    #...#.#.......##.#..#....#.#...
    #...#......###.....###........#
    ..#.##...##....#...#....#.#....
    #....#..###....##.#......##...#
    ##.#...#..........#.##....#..#.
    .##....#............###.#...#..
    ###.##.#####.##.....##..#####..
    ..###.###.......#.#...#....#...
    .#...#....####.........#.......
    ..##.#.#......#....#.#....#.#.#
    #.####.....#....#..#.....#.##..
    ###.###.##...##.#.#.#.....#.#..
    .......#.....#.......##.#.....#
    #..#.##...#........#.#.......##
    #.#........#...#....#..........
    ..#....##.#......#..#..........
    #....##.....#.....#.##.#...#...
    ....#.#.....#....####...#.#.##.
    ......#.......##...##.#......#.
    .#.........##...#..#..##..#....
    .#...##.....##.#....#..........
    ....#.###..##..#...#..........#
    ......#...#.#.#........##......
    .#..........#.#.....#..##..#.#.
    .......###.#......#....#.#..#..
    ..##.......#....#....#.#...##.#
    #.##.#.......#..###..##...#.#..
    ......####....#.#.....#...#..#.
    #.##.###..#..#.#.....###..#.#.#
    #.#.#..#.#..##...#...#..##.###.
    ....##..##.#...............#.#.
    ..###.#.#.##..#....##.......#..
    #.#....#..........##......#####
    .#.#.......##.#.#......##..#.#.
    ......#.###.##.#..#....#.##....
    ..###........#.......##.#.#....
    .#..##.............#.##.###...#
    .#####...#......#.......##.....
    ##..###.#...#....#..#....#.#..#
    .#.........###.##.....##.....##
    .##.#....#..#.#..##..#....##...
    .#..#..#......###...#.......#..
    #.#...#.....#..#.#.#..#..###...
    ....#....#..#..#....#..#.#.#...
    ......#.......#.#.#.#.....#....
    ###...#...#......#..#.#.#..#.#.
    #...##.##.##........##....#....
    .....#.......#...#...#.#.#....#
    ...##.....##.#...#.#.#.#..#..#.
    .#.......##...........#...#.##.
    .##..........#......#.#...###..
    .....##...#.....#...#......#...
    ...........#.....#..#...#..#.#.
    #.....##..#...........##....#..
    #.##...###.###....##..#..#....#
    #.#.##...##....###....##.##....
    .#..###.....#......#...#...#..#
    ..#...#....#.#.###.#..#......#.
    ......#.........#..#.##...#...#
    ..#.#....##.#..##..##...#....#.
    #.....#....##.........##.#.....
    ...#...#..###.###......##...###
    .##.###...##..#.##....##.#..#..
    ..#..#.......#................#
    .....#..#.#.#..........##..#...
    ......###.#.#............#..#.#
    ..#.##.....##....#...#...#.#...
    ..#......##...#...##........#..
    #.....#.....#..#......#.###...#
    ....#..#.#.....#...#....#.#...#
    #.......#..#...##..#.#..#.##...
    ..#......###...#.........##...#
    ...#.......##.....#..##........
    .#....#.#.....##.#.#...........
    ##..#..#...#.##.#.#.#.#.#..##.#
    ##...####.#.#.##...#..#......#.
    #.##..####.##.#.........#...###
    #...#.......#.#..####.#.#.#....
    #....#........#........#.......
    ..#..####.....#....##...###.##.
    ...#.#..####.........#....#.##.
    ##.#...#...#..#.#..##.....##...
    ....#.........#.##........##.#.
    ##...#......#....#..#....#....#
    ###.....#......##...#...##...#.
    #.##...............#.......#...
    .##.#...#..#....#.#.....###..#.
    .....##...#.##.....##...#....#.
    #.#..#..........#####..##......
    ..#.........##...#.........#.##
    ...#..##.#.#..#......#..###.###
    #..#...#.#...##..........#.....
    .###..#....###.....#....#..###.
    #..#....#...#........##.....#..
    .#..###........#....#..####..##
    .#..#.#.#.......##.#..##.#..##.
    ..#..###......##....#..#..#..#.
    .......###..##....#......#...##
    #........#.##.............##.#.
    ...#.#.#....##....##.###...#...
    ..#.....#..##..#.#.......#.####
    .#......##.........##...#.....#
    .#.###........##....###.#.#...#
    ##...#.#....#.....##.......#..#
    #...........#...........####...
    #..#.#..##..#...#....#.##....#.
    ................##.............
    ..##...#.#....##....#...#......
    .#.....#....#....#..#..#.#..##.
    .....######.#.#.##.###.#.......
    ..#####....#..#...........#.#..
    .......#..#..##.#...###.#.#.###
    ###...#...#..##.#.##..#...#..#.
    .#..#..............#...........
    .#.....#.....##....#....##..#..
    ....#####.#....#......#.......#
    .#.#.....##.####..#...#.......#
    .#...##.#.......#.....##.#..##.
    ..........#...#....###....#...#
    ..#......#...#...#..#.#........
    .......#.......#..####..##.....
    .#..#.....###...#...#...#...#..
    ##..#.......#.#...#..#..#.##..#
    #..#...#.#.....#.##.#........#.
    ......#......#.#..###.##..###..
    .#..#..#.##.#...........#...##.
    .#....#...#.#..#.#.#...##.#..#.
    ##.#....#..#..#.#...#......#.#.
    ..#.#............##...#........
    ...####...#...#.....##..#...###
    ....###.......###.##..#.###....
    #......#.#....#.#.##.#.##..###.
    .....##.....#..##.....##....#..
    ..#...#..##.#.##.#.#.#.......##
    #....#..##.......#......#..#.##
    #.....##...#..##......##.#.#..#
    ....#..##..#.##...#.#.##..#..##
    #..#...##....##..#...#....#...#
    .##.#.#....#.....#........##.#.
    ..##..#....#........#.....#....
    .##.#..##...#.....#...###.....#
    #..#..#........#..#.....#.#.#.#
    ..##..###.#..#...#.#......#..#.
    #.....#.....#.###......##..#.#.
    .........#...##.........#...#..
    .##.#.##......#.#...###..#....#
    ...##.#..###........##......#..
    ...#.#...#......#.#.#....#..#..
    ..####.........#..#....#.......
    #..#.........##.#.##....#.....#
    ..#..#..#.#........#.###.......
    ##.#..#..#....#...##.......#..#
    ..#.#.....#.............#...##.
    ..........#...##.....#..#.#..#.
    ....#..#...#..##..#...##.#.....
    ##....#......#..#.....#..#.....
    ...#.#.#.#...........##...#.#..
    ....#.###...#............#.....
    .#.#.#.......#.#......#....#.#.
    #.#.#.#..##.#..#..##...##.#..#.
    .#.##....##..#........#....#...
    ####...#....#.#...#..#..###...#
    .....#.#.##.......##..#.######.
    .......#.#.#.....#.#..##....#..
    ..#....#.#..#.#.#..#..#........
    .....##......#.........#.#...##
    #....##.#.....#..........#.#...
    #...#.#..#.#..#.#....#..#.#....
    ....##........#................
    ###.#.#...#..##...#...#.##...#.
    ...#....###..#..##..#..#.......
    .....#..........#.#........##.#
    .#........#.##.#..##..#...#...#
    ..##....#...#.#.........##.#...
    ......#...#......#.....#.......
    ....##.##..#.##...#.#.#.##.#.#.
    ..#...#.....#.#....##.#........
    .#.#.......#.......###..#..#...
    #...#..#..#..##....#...#.....#.
    .#..####.##.....##.........#.#.
    #...###.......#...####..##.....
    #.##.#....#.#.##.......#...#...
    ..#.......#.#.##.##..#...##....
    .#.......#.#..#.....#.....#.#..
    ..#..#.......##.....#.#.....#.#
    #...###..#..#..##...#.....#..##
    ......#................#.......
    ..#.....##..#.......#...#...##.
    ...##...####.#..#...#.......##.
    ..#...#..#...#...#..#..#####...
    #..#...#....#....#...........#.
    ..#.......#..#.##...##..###...#
    .#..#..#......##...#....#......
    ...#..##....#..........#.....#.
    ###...#.#......#.#.....#.....##
    #.#..#.....#........#.##.#.##..
    ....#...#.....#..#.......#.#...
    #.#...##....#..#.....#...#.#.#.
    .#......#...##..#.......#......
    ...#...#.#.#.###.#..#.#..#.....
    ###...#..###.#...#..##...####..
    .#.#.#..#........#..#......#..#
    .#..#....#......#....#.#...#...
    .##..........###...##.....#.#..
    .#...#.#.##.##..###.#...#..###.
    ......#......#......#.##......#
    ..#.##..#.#..#....##..##...#...
    .#......#..#...##....#...#.....
    .#.....#.##..........#..#......
    ###.#..#.##..#..##...#..#...#..
    #.....###........#.#..##.#.....
    .....#.......##.....##.....#.##
    ...##.#......####....##........
    ..#..#..#....#.##.....##.####..
    ...#..#....#.#..#.#..#.#.#..#..
    #..........#....#.#.#.#...#..#.
    ...####.##...#..#.......#.#..##
    #........#..#..................
    .#..#....#.#.#..#..........#...
    ###...#....####....#......#..#.
    #.........####..#..#...........
    .....##..#..##.##.##.#..#.....#
    .#..#.#.##..#..#.#.#.##.###....
    ......##......#...#.##....#..#.
    .#.#....#..#......#..#...###...
    .##...#......##...###...#.#...#
    .......#.#....#............#..#
    .#..##.#.######...#...#......#.
    "
}